<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ØªØ­Ù„ÛŒÙ„ ÙˆØ§Ø¨Ø³ØªÚ¯ÛŒ Ù‚ÛŒÙ…Øª Ø·Ù„Ø§ | Economali</title>
    <style>
        :root {
            --bg-color: #f3f4f6;
            --card-bg: #ffffff;
            --text-color: #1f2937;
            --border-color: #e5e7eb;
            --gold-primary: #b48ead; /* Ú©Ù…ÛŒ Ù…Ø¯Ø±Ù†â€ŒØªØ± */
            --gold-accent: #d4af37;
            --brand-color: #111827;
            --brand-hover: #374151;
        }
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--bg-color);
            margin: 0;
            padding: 20px;
            color: var(--text-color);
            box-sizing: border-box;
        }
        .container {
            max-width: 100%; /* Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø² ØªÙ…Ø§Ù… Ø¹Ø±Ø¶ ØµÙØ­Ù‡ */
            margin: 0 auto;
            display: grid;
            grid-template-columns: 200px 1fr; /* Ø¹Ø±Ø¶ Ø³Ø§ÛŒØ¯Ø¨Ø§Ø± Ø¨Ù‡ Û²Û°Û° Ù¾ÛŒÚ©Ø³Ù„ Ú©Ø§Ù‡Ø´ ÛŒØ§ÙØª */
            gap: 15px; /* ÙØ§ØµÙ„Ù‡ Ø¨ÛŒÙ† Ø³ØªÙˆÙ†â€ŒÙ‡Ø§ Ú©Ù…ÛŒ Ú©Ù…ØªØ± Ø´Ø¯ */
            align-items: start;
        }
        .sidebar {
            background: var(--card-bg);
            padding: 15px; /* ÙØ¶Ø§ÛŒ Ø¯Ø§Ø®Ù„ÛŒ Ø³Ø§ÛŒØ¯Ø¨Ø§Ø± ÙØ´Ø±Ø¯Ù‡â€ŒØªØ± Ø´Ø¯ */
            border-radius: 16px;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            position: sticky;
            top: 20px;
            border: 1px solid var(--border-color);
        }
        .brand-title {
            text-align: center;
            font-size: 1.3rem; /* Ø¹Ù†ÙˆØ§Ù† Ø¨Ø±Ù†Ø¯ Ú©ÙˆÚ†Ú©ØªØ± Ø´Ø¯ */
            font-weight: 900;
            color: var(--brand-color);
            margin-bottom: 5px;
            letter-spacing: -0.5px;
            padding-bottom: 10px;
            border-bottom: 3px solid var(--gold-accent);
            margin-bottom: 15px;
        }
        .main-content {
            background: var(--card-bg);
            padding: 20px;
            border-radius: 16px;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            overflow: hidden; 
            border: 1px solid var(--border-color);
            display: flex;
            flex-direction: column;
        }
        .table-wrapper {
            overflow-x: auto;
            width: 100%;
            border-radius: 8px;
            border: 1px solid var(--border-color);
        }
        h1 {
            color: var(--brand-color);
            margin-top: 0;
            font-size: 1.3rem;
            padding-bottom: 10px;
            border-bottom: 1px solid #eee;
            margin-bottom: 15px;
        }
        h2 {
            font-size: 1rem; /* Ø¹Ù†ÙˆØ§Ù† ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ú©ÙˆÚ†Ú©ØªØ± Ø´Ø¯ */
            color: #4b5563;
            margin-bottom: 15px;
            font-weight: 700;
        }
        .input-group {
            margin-bottom: 12px; /* ÙØ§ØµÙ„Ù‡ Ø¨ÛŒÙ† ÙˆØ±ÙˆØ¯ÛŒâ€ŒÙ‡Ø§ Ú©Ù…ØªØ± Ø´Ø¯ */
        }
        label {
            display: block;
            margin-bottom: 4px;
            font-weight: 600;
            font-size: 0.8rem; /* ÙÙˆÙ†Øª Ù„ÛŒØ¨Ù„â€ŒÙ‡Ø§ Ø±ÛŒØ²ØªØ± Ø´Ø¯ */
            color: #374151;
        }
        input {
            width: 100%;
            padding: 8px; /* Ø§Ø±ØªÙØ§Ø¹ Ø§ÛŒÙ†Ù¾ÙˆØªâ€ŒÙ‡Ø§ Ú©Ù…ØªØ± Ø´Ø¯ */
            border: 2px solid var(--border-color);
            border-radius: 8px;
            box-sizing: border-box;
            font-family: inherit;
            font-size: 0.9rem;
            font-weight: 500;
            transition: all 0.2s;
            background-color: #f9fafb;
        }
        input:focus {
            outline: none;
            border-color: var(--gold-accent);
            background-color: #fff;
            box-shadow: 0 0 0 3px rgba(212, 175, 55, 0.1);
        }
        button {
            width: 100%;
            padding: 10px; /* Ø¯Ú©Ù…Ù‡ Ø¬Ù…Ø¹â€ŒÙˆØ¬ÙˆØ±ØªØ± Ø´Ø¯ */
            background-color: var(--brand-color);
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            font-size: 0.9rem;
            margin-top: 8px;
            transition: background-color 0.2s;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        button:hover {
            background-color: var(--brand-hover);
            transform: translateY(-1px);
        }
        button:active {
            transform: translateY(0);
        }
        table {
            width: 100%;
            border-collapse: separate;
            border-spacing: 0;
            font-size: 0.85rem; /* ÙÙˆÙ†Øª Ú©ÙˆÚ†Ú©ØªØ± Ø¨Ø±Ø§ÛŒ Ø¬Ø§ Ø´Ø¯Ù† Ø¨Ù‡ØªØ± */
            min-width: auto; /* Ø­Ø°Ù Ù…Ø­Ø¯ÙˆØ¯ÛŒØª Ø¹Ø±Ø¶ */
        }
        th, td {
            padding: 8px 6px; /* ÙØ§ØµÙ„Ù‡ Ú©Ù…ØªØ± Ø³Ù„ÙˆÙ„â€ŒÙ‡Ø§ */
            text-align: center;
            border-bottom: 1px solid #eee;
            border-left: 1px solid #eee; 
        }
        /* Ø§ØµÙ„Ø§Ø­ Ø¨Ø±Ø¯Ø±Ù‡Ø§ Ø¨Ø±Ø§ÛŒ RTL */
        th:last-child, td:last-child {
             border-left: none;
        }

        th {
            background-color: var(--brand-color);
            color: white;
            font-weight: 500;
            position: sticky;
            top: 0;
            z-index: 10;
            white-space: nowrap;
            font-size: 0.8rem;
        }
        
        /* Ú¯ÙˆØ´Ù‡ Ù‡Ø§ÛŒ Ù‡Ø¯Ø± Ø¬Ø¯ÙˆÙ„ */
        th:first-child { border-top-right-radius: 8px; } 
        th:last-child { border-top-left-radius: 8px; } 

        .row-header {
            background-color: var(--gold-accent);
            color: white;
            font-weight: bold;
            position: sticky;
            right: 0;
            z-index: 5;
            border-left: 2px solid rgba(255,255,255,0.2);
            box-shadow: -2px 0 5px rgba(0,0,0,0.05);
            white-space: nowrap;
            font-size: 0.8rem;
        }
        
        .formula-info {
            font-size: 0.85em;
            color: #6b7280;
            margin-top: 25px;
            padding: 16px;
            background-color: #f3f4f6;
            border-radius: 10px;
            line-height: 1.8;
            border: 1px dashed #d1d5db;
        }
        
        /* Heatmap Colors - Slightly softer for better readability */
        .heatmap-low { background-color: #ecfdf5; color: #047857; } 
        .heatmap-mid-low { background-color: #fefce8; color: #b45309; }
        .heatmap-mid-high { background-color: #ffedd5; color: #c2410c; }
        .heatmap-high { background-color: #fef2f2; color: #b91c1c; }

        .result-cell {
            font-family: 'Courier New', Courier, monospace; 
            font-weight: 600;
            transition: all 0.2s;
            cursor: default;
            white-space: nowrap; /* Ø¬Ù„ÙˆÚ¯ÛŒØ±ÛŒ Ø§Ø² Ø´Ú©Ø³ØªÙ† Ø®Ø· Ø§Ø¹Ø¯Ø§Ø¯ */
        }
        .result-cell:hover {
            transform: scale(1.1);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            z-index: 2;
            position: relative;
            border-radius: 4px;
        }

        .footer-brand {
            text-align: center;
            margin-top: auto;
            padding-top: 15px;
            font-size: 0.75rem;
            color: #9ca3af;
        }

        @media (max-width: 900px) {
            .container { 
                grid-template-columns: 1fr; 
                gap: 20px;
            }
            .sidebar { 
                position: static; 
                margin-bottom: 0;
            }
        }
    </style>
</head>
<body>

<div class="container">
    <div class="sidebar">
        <div class="brand-title">Economali</div>
        <h2>âš™ï¸ ØªÙ†Ø¸ÛŒÙ…Ø§Øª ØªØ­Ù„ÛŒÙ„</h2>
        
        <div class="input-group">
            <label>ğŸ’° Ù‚ÛŒÙ…Øª Ù¾Ø§ÛŒÙ‡ Ø§Ù†Ø³ Ø¬Ù‡Ø§Ù†ÛŒ ($):</label>
            <input type="number" id="baseOunce" value="4000">
        </div>
        <div class="input-group">
            <label>ğŸ“Š Ú¯Ø§Ù… Ù†ÙˆØ³Ø§Ù† Ø§Ù†Ø³ ($):</label>
            <input type="number" id="stepOunce" value="50">
        </div>

        <hr style="border-color: #eee; margin: 20px 0;">

        <div class="input-group">
            <label>ğŸ’µ Ù‚ÛŒÙ…Øª Ù¾Ø§ÛŒÙ‡ Ø¯Ù„Ø§Ø± (ØªÙˆÙ…Ø§Ù†):</label>
            <input type="number" id="baseDollar" value="100000">
        </div>
        <div class="input-group">
            <label>ğŸ“ˆ Ú¯Ø§Ù… Ù†ÙˆØ³Ø§Ù† Ø¯Ù„Ø§Ø± (ØªÙˆÙ…Ø§Ù†):</label>
            <input type="number" id="stepDollar" value="3000">
        </div>

        <button onclick="generateTable()">ğŸ”„ Ù…Ø­Ø§Ø³Ø¨Ù‡ Ù…Ø¬Ø¯Ø¯</button>

        <div class="formula-info">
            <strong>ğŸ§® ÙØ±Ù…ÙˆÙ„ Ù…Ø­Ø§Ø³Ø¨Ø§ØªÛŒ Economali:</strong><br>
            Ù‚ÛŒÙ…Øª Û± Ú¯Ø±Ù… Û±Û¸ Ø¹ÛŒØ§Ø± (Û·ÛµÛ°) Ø¨Ø± Ø§Ø³Ø§Ø³ Ø§Ù†Ø³ Û¹Û¹.Û¹Û¹:<br>
            <code dir="ltr" style="display:block; margin-top:5px; text-align:center;">(Ounce Ã— USD Ã· 31.1035) Ã— (750 Ã· 999.9)</code>
        </div>
    </div>

    <div class="main-content">
        <h1>ØªØ­Ù„ÛŒÙ„ ÙˆØ§Ø¨Ø³ØªÚ¯ÛŒ Ù‚ÛŒÙ…Øª Ø·Ù„Ø§ (Ù…ÛŒÙ„ÛŒÙˆÙ† ØªÙˆÙ…Ø§Ù†)</h1>
        <div class="table-wrapper">
            <div id="tableContainer"></div>
        </div>
        <div class="footer-brand">Powered by Economali Analysis Tools Â© 2025</div>
    </div>
</div>

<script>
    // Ø«Ø§Ø¨Øªâ€ŒÙ‡Ø§ÛŒ ØªØ¨Ø¯ÛŒÙ„
    const OUNCE_TO_GRAM = 31.1034768;
    const KARAT_FACTOR = 750 / 999.9; 

    function formatNumber(num) {
        // Ø±Ù†Ø¯ Ú©Ø±Ø¯Ù† Ø¨Ù‡ Ù†Ø²Ø¯ÛŒÚ©ØªØ±ÛŒÙ† Ø¹Ø¯Ø¯ ØµØ­ÛŒØ­ Ùˆ Ø§Ø¶Ø§ÙÙ‡ Ú©Ø±Ø¯Ù† Ø¬Ø¯Ø§Ú©Ù†Ù†Ø¯Ù‡ Ù‡Ø²Ø§Ø±Ú¯Ø§Ù†
        return Math.round(num).toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
    }
    
    function formatMillion(num) {
        // Ù†Ù…Ø§ÛŒØ´ Ø¨Ù‡ ØµÙˆØ±Øª Ù…ÛŒÙ„ÛŒÙˆÙ† Ø¨Ø§ Û³ Ø±Ù‚Ù… Ø§Ø¹Ø´Ø§Ø±
        return (num / 1000000).toFixed(3);
    }

    function calculateGoldPrice(ounce, dollar) {
        // Ù‚ÛŒÙ…Øª ÛŒÚ© Ú¯Ø±Ù… Ø·Ù„Ø§ÛŒ Û²Û´ Ø¹ÛŒØ§Ø± (Ø¨Ø§ ÙØ±Ø¶ Ø®Ù„ÙˆØµ 999.9 Ø¨Ø±Ø§ÛŒ Ø§Ù†Ø³)
        let gram24k = (ounce * dollar) / OUNCE_TO_GRAM;
        // ØªØ¨Ø¯ÛŒÙ„ Ø¨Ù‡ Ø·Ù„Ø§ÛŒ Û±Û¸ Ø¹ÛŒØ§Ø± (Û·ÛµÛ°)
        let gram18k = gram24k * KARAT_FACTOR;
        return gram18k;
    }

    function getColorClass(value, min, max) {
        const range = max - min;
        const percent = (value - min) / range;

        if (percent < 0.25) return 'heatmap-low';
        if (percent < 0.5) return 'heatmap-mid-low';
        if (percent < 0.75) return 'heatmap-mid-high';
        return 'heatmap-high';
    }

    function generateTable() {
        const baseOunce = parseFloat(document.getElementById('baseOunce').value);
        const stepOunce = parseFloat(document.getElementById('stepOunce').value);
        const baseDollar = parseFloat(document.getElementById('baseDollar').value);
        const stepDollar = parseFloat(document.getElementById('stepDollar').value);

        if (isNaN(baseOunce) || isNaN(stepOunce) || isNaN(baseDollar) || isNaN(stepDollar)) {
            alert("Ù„Ø·ÙØ§ ØªÙ…Ø§Ù… Ù…Ù‚Ø§Ø¯ÛŒØ± Ø±Ø§ Ø¨Ù‡ Ø¯Ø±Ø³ØªÛŒ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯.");
            return;
        }

        // Ø³Ø§Ø®Øª Ø¢Ø±Ø§ÛŒÙ‡â€ŒÙ‡Ø§ÛŒ Ù…Ø­ÙˆØ±Ù‡Ø§
        let ounces = [];
        let dollars = [];
        
        // Ø§ÙØ²Ø§ÛŒØ´ ØªØ¹Ø¯Ø§Ø¯ Ø±Ø¯ÛŒÙâ€ŒÙ‡Ø§ Ø¨Ù‡ 15 (Ø§Ø² -7 ØªØ§ +7)
        for(let i = -7; i <= 7; i++) {
            ounces.push(baseOunce + (i * stepOunce));
            dollars.push(baseDollar + (i * stepDollar));
        }

        // ÛŒØ§ÙØªÙ† Ù…ÛŒÙ†ÛŒÙ…Ù… Ùˆ Ù…Ø§Ú©Ø²ÛŒÙ…Ù… Ø¨Ø±Ø§ÛŒ Ù‡ÛŒØªâ€ŒÙ…Ù¾ (Heatmap)
        let minPrice = calculateGoldPrice(ounces[0], dollars[0]);
        let maxPrice = calculateGoldPrice(ounces[ounces.length-1], dollars[dollars.length-1]);

        let html = '<table><thead><tr><th>Ø§Ù†Ø³ ğŸ‘‡ / Ø¯Ù„Ø§Ø± ğŸ‘ˆ</th>';
        
        // Ù‡Ø¯Ø± Ø³ØªÙˆÙ†â€ŒÙ‡Ø§ (Ø¯Ù„Ø§Ø±)
        dollars.forEach(d => {
            html += `<th>${formatNumber(d)}</th>`;
        });
        html += '</tr></thead><tbody>';

        // Ø±Ø¯ÛŒÙâ€ŒÙ‡Ø§ (Ø§Ù†Ø³)
        ounces.forEach(o => {
            html += `<tr><td class="row-header">${o} $</td>`;
            dollars.forEach(d => {
                let price = calculateGoldPrice(o, d);
                let colorClass = getColorClass(price, minPrice, maxPrice);
                // Ù†Ù…Ø§ÛŒØ´ Ø¨Ù‡ ØµÙˆØ±Øª Ù…ÛŒÙ„ÛŒÙˆÙ† ØªÙˆÙ…Ø§Ù†
                let displayPrice = formatMillion(price);
                
                html += `<td class="result-cell ${colorClass}" title="Ø§Ù†Ø³: ${o}$ | Ø¯Ù„Ø§Ø±: ${formatNumber(d)} ØªÙˆÙ…Ø§Ù† | Ù‚ÛŒÙ…Øª Ø¯Ù‚ÛŒÙ‚: ${formatNumber(price)}">${displayPrice}</td>`;
            });
            html += '</tr>';
        });

        html += '</tbody></table>';
        document.getElementById('tableContainer').innerHTML = html;
    }

    // Ø§Ø¬Ø±Ø§ÛŒ Ø§ÙˆÙ„ÛŒÙ‡ Ù‡Ù†Ú¯Ø§Ù… Ù„ÙˆØ¯ ØµÙØ­Ù‡
    window.onload = generateTable;
</script>

</body>
</html>